Add more params for safer trades
Rewrite in Golang
